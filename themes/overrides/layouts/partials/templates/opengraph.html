{{/* themes/overrides/layouts/partials/templates/opengraph.html */}}

{{- /* First render the default OG tags (minus image) */ -}}
{{ partial "templates/opengraph.html" . | safeHTML }}

{{- /* Fallback: if user didnâ€™t set featuredImage, grab first <img> from .Content */ -}}
{{- if not .Params.featuredImage }}
  {{- $match := findRE `(?i)<img[^>]+src="([^"]+)"` .Content }}
  {{- if gt (len $match) 0 }}
    {{- $firstImgTag := index $match 0 }}
    {{- $firstImg := replaceRE `(?i)<img[^>]+src="([^"]+)"` "$1" $firstImgTag }}
    <meta property="og:image" content="{{ $firstImg }}" />
  {{- end }}
{{- end }}
